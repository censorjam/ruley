{
    "debug": false,

    "globals": {
    },

    "parameters": [
        { "name": "rabbitmq events", "host": "localhost", "port": 15672, "vhost": "events", "username": "guest" },
        { "name": "rabbitmq core", "host": "d1rmq001", "port": 15672, "vhost": "core", "username": "guest" }
    ],

    "template": {
        "input": {
            "$type": "Ruley.Core.Inputs.PollingInput, Ruley",
            "interval": 5000
        },

        "filters": [
            {
                "$type": "@http",
                "url": "http://{host}:{port}/api/aliveness-test/{vhost}",
                "username": "{username}",
                "password": "guest",
                "authentication": "basic",
                "timeout": 3000
            },
            {
                "$type": "@map",
                "field": "statusCode",
                "destination": "status",
                "mapping": [
                    [ 200, "Healthy" ]
                ],
                "default": "Unhealthy"
            },
            {
                "$type": "@map",
                "field": "gotResponse",
                "destination": "info",
                "mapping": [
                    [ false, "Unable to connect" ]
                ],
                "default": "",
                "test": ""
            },
            {
                "$type": "@distinctvalue",
                "field": "status"
            },
            {
                "$type": "@addfield",
                "destination": "type",
                "value": "rabbitmq"
            },
            {
                "$type": "@bus.pub",
                "key": "health-check"
            }
        ],

        "outputs": [
            {
                "$type": "@console",
                "enabled": false
            }
        ]
    }
}
