{
    "debug": false,

    "globals": {
        "type": "rabbitmq"
    },

    "parameters": [
        {
            "name": "rabbitmq events",
            "host": "localhost",
            "port": 15672,
            "vhost": "events",
            "authentication": {
                "username": "guest"
            }
        },
        {
            "name": "rabbitmq core",
            "host": "rmq001",
            "port": 15672,
            "vhost": "sdffd",
            "authentication": { "username": "guest" }
        }
    ],

    "template": {
        "input": {
            "$type": "Ruley.Core.Inputs.PollingInput, Ruley",
            "interval": 5000
        },

        "filters": [
            {
                "$type": "@template",
                "template": "http://{{host}}:{{port}}/api/aliveness-test/{{vhost}}",
                "destination": "url"
            },
            {
                "$type": "@http",
                "url": "{{url}}",
                "username": "{{authentication.username}}",
                "password": "guest",
                "authentication": "basic",
                "timeout": 3000
            },
            {
                "$type": "@map",
                "field": "statusCode",
                "destination": "status",
                "mapping": [
                    [ 200, "Healthy" ]
                ],
                "default": "Unhealthy"
            },
            {
                "$type": "@template",
                "template": "Status Code: {statusCode}\nUrl: {url}\nException: {exception}",
                "destination": "info"
            },
            {
                "$type": "@distinctvalue",
                "field": "status"
            },
            {
                "$type": "@addfield",
                "destination": "type",
                "value": "rabbitmq"
            },
            {
                "$type": "@bus.pub",
                "key": "health-check"
            }
        ],

        "outputs": [
            {
                "$type": "@console",
                "enabled": false
            }
        ]
    }
}
