{
    "debug": false,

    "globals": {
    },

    "parameters": [
        {
        }
    ],

    "template": {
        "input": {
            "$type": "@bus.in",
            "key": "health-check"
        },

        "filters": [
            {
                "$type": "@map",
                "field": "status",
                "destination": "emoji",
                "mapping": [
                    [ "Healthy", ":ok:" ]
                ],
                "default": ":ambulance:"
            },
            {
                "$type": "@map",
                "field": "status",
                "destination": "infoMessage",
                "mapping": [
                    [ "Healthy", null ]
                ],
                "default": "\n{info}"
            },
            {
                "$type": "@map",
                "field": "status",
                "destination": "sendSlack",
                "mapping": [
                    [ "Healthy", false ]
                ],
                "default": true
            },
            {
                "$type": "@if",
                "field": "sendSlack",
                "then": {
                    "$type": "@slack",
                    "enabled": true,
                    "webHookUrl": "@slack_url",
                    "username": "health-bot",
                    "emoji": "{emoji}",
                    "message": "*{name}* on {host} is *{status}*{infoMessage}"
                },
                "else": {
                    "$type": "@console",
                    "enabled": true
                }
            }
        ],

        "outputs": [
            {
                "$type": "@console",
                "enabled": false
            }
        ]
    }
}
